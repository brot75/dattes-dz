{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/components/CookieConsent.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Cookie, X, Check } from 'lucide-react';\r\nimport { useStore } from '@/lib/store';\r\n\r\nexport function CookieConsent() {\r\n    const [isVisible, setIsVisible] = useState(false);\r\n\r\n    // Check if user has already consented\r\n    useEffect(() => {\r\n        const consent = localStorage.getItem('cookie-consent');\r\n        if (!consent) {\r\n            // Delay slightly for better UX\r\n            const timer = setTimeout(() => setIsVisible(true), 1500);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, []);\r\n\r\n    const handleAccept = () => {\r\n        localStorage.setItem('cookie-consent', 'accepted');\r\n        setIsVisible(false);\r\n        // Here we would technically enable real tracking scripts\r\n        console.log('Cookies accepted - Tracking enabled');\r\n    };\r\n\r\n    const handleDecline = () => {\r\n        localStorage.setItem('cookie-consent', 'declined');\r\n        setIsVisible(false);\r\n    };\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {isVisible && (\r\n                <motion.div\r\n                    initial={{ y: 100, opacity: 0 }}\r\n                    animate={{ y: 0, opacity: 1 }}\r\n                    exit={{ y: 100, opacity: 0 }}\r\n                    className=\"fixed bottom-24 left-4 right-4 md:bottom-4 md:left-4 md:right-auto md:w-96 z-50 pointer-events-none\"\r\n                >\r\n                    <div className=\"bg-white/90 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-gray-100 pointer-events-auto relative overflow-hidden\">\r\n                        {/* Decor */}\r\n                        <div className=\"absolute top-0 right-0 p-4 opacity-5\">\r\n                            <Cookie className=\"w-24 h-24 rotate-12\" />\r\n                        </div>\r\n\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"flex items-start gap-4 mb-4\">\r\n                                <div className=\"p-3 bg-dattes-primary/10 rounded-full text-dattes-primary\">\r\n                                    <Cookie className=\"w-6 h-6\" />\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"font-bold text-gray-900\">Cookies & Confidentialité</h3>\r\n                                    <p className=\"text-xs text-gray-500 mt-1 leading-relaxed\">\r\n                                        Nous utilisons des cookies pour récupérer les données de trafic (Facebook, TikTok, Instagram) et améliorer votre expérience.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-2\">\r\n                                <button\r\n                                    onClick={handleDecline}\r\n                                    className=\"flex-1 py-2 px-4 rounded-xl text-xs font-bold text-gray-500 hover:bg-gray-100 transition-colors\"\r\n                                >\r\n                                    Refuser\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleAccept}\r\n                                    className=\"flex-1 py-2 px-4 rounded-xl text-xs font-bold text-white bg-dattes-primary hover:bg-black transition-colors shadow-lg shadow-dattes-primary/20 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <Check className=\"w-3 h-3\" />\r\n                                    Accepter\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AAAA;AAJA;;;;;AAOO,SAAS;IACZ,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,sCAAsC;IACtC,IAAA,kNAAS,EAAC;QACN,MAAM,UAAU,aAAa,OAAO,CAAC;QACrC,IAAI,CAAC,SAAS;YACV,+BAA+B;YAC/B,MAAM,QAAQ,WAAW,IAAM,aAAa,OAAO;YACnD,OAAO,IAAM,aAAa;QAC9B;IACJ,GAAG,EAAE;IAEL,MAAM,eAAe;QACjB,aAAa,OAAO,CAAC,kBAAkB;QACvC,aAAa;QACb,yDAAyD;QACzD,QAAQ,GAAG,CAAC;IAChB;IAEA,MAAM,gBAAgB;QAClB,aAAa,OAAO,CAAC,kBAAkB;QACvC,aAAa;IACjB;IAEA,qBACI,8OAAC,4MAAe;kBACX,2BACG,8OAAC,oMAAM,CAAC,GAAG;YACP,SAAS;gBAAE,GAAG;gBAAK,SAAS;YAAE;YAC9B,SAAS;gBAAE,GAAG;gBAAG,SAAS;YAAE;YAC5B,MAAM;gBAAE,GAAG;gBAAK,SAAS;YAAE;YAC3B,WAAU;sBAEV,cAAA,8OAAC;gBAAI,WAAU;;kCAEX,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC,gNAAM;4BAAC,WAAU;;;;;;;;;;;kCAGtB,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCAAI,WAAU;kDACX,cAAA,8OAAC,gNAAM;4CAAC,WAAU;;;;;;;;;;;kDAEtB,8OAAC;;0DACG,8OAAC;gDAAG,WAAU;0DAA0B;;;;;;0DACxC,8OAAC;gDAAE,WAAU;0DAA6C;;;;;;;;;;;;;;;;;;0CAMlE,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCACG,SAAS;wCACT,WAAU;kDACb;;;;;;kDAGD,8OAAC;wCACG,SAAS;wCACT,WAAU;;0DAEV,8OAAC,6MAAK;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjE"}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/lib/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\n\r\nexport type Language = 'fr' | 'ar' | 'en';\r\n\r\nexport interface CartItem {\r\n    id: string;\r\n    productId: string;\r\n    name: string;\r\n    quality: string;\r\n    type: string;\r\n    quantityKg: number;\r\n    pricePerKg: number;\r\n    image: string;\r\n    unit?: string; // kg, liter, piece, box\r\n    packaging?: string; // arjoun, messier, standard\r\n}\r\n\r\nexport interface InventoryItem {\r\n    id: string;\r\n    type: string;\r\n    quality: string;\r\n    pricePerKg: number;\r\n    purchasePrice?: number; // For Profit Calculation\r\n    stockKg: number;\r\n    unit?: string; // Default 'kg'\r\n    packaging?: string; // Default 'standard'\r\n    images: string[];\r\n    description: string;\r\n    origin?: string;\r\n    longDescription?: string;\r\n\r\n    // Arabic Translations\r\n    typeAr?: string;\r\n    qualityAr?: string;\r\n    originAr?: string;\r\n    descriptionAr?: string;\r\n    longDescriptionAr?: string;\r\n\r\n    // English\r\n    nameEn?: string;\r\n    typeEn?: string;\r\n    qualityEn?: string;\r\n    originEn?: string;\r\n    descriptionEn?: string;\r\n    longDescriptionEn?: string;\r\n\r\n    nutritionalInfo?: {\r\n        calories: number;\r\n        carbs: number;\r\n        protein: number;\r\n        fiber: number;\r\n    };\r\n}\r\n\r\nexport interface Order {\r\n    id: string;\r\n    userId?: string;\r\n    customer: {\r\n        name: string;\r\n        phone: string;\r\n        wilaya: string;\r\n        commune: string;\r\n        address?: string;\r\n    };\r\n    items: CartItem[];\r\n    total: number;\r\n    status: 'pending' | 'shipped' | 'completed' | 'cancelled' | 'returned';\r\n    date: string;\r\n    returnReason?: string;\r\n    source?: string; // 'instagram', 'facebook', 'tiktok', 'direct', etc.\r\n}\r\n\r\nexport interface SiteSettings {\r\n    heroImage: string;\r\n    heroImageDesktop?: string;\r\n    deliveryFees: Record<string, { home: number, bureau: number }>; // Wilaya name -> Price\r\n}\r\n\r\nexport interface User {\r\n    id: string;\r\n    email: string;\r\n    password?: string;\r\n    role: 'admin' | 'customer';\r\n    name: string;\r\n    phone?: string;\r\n    wilaya?: string;\r\n    commune?: string;\r\n}\r\n\r\nexport const WILAYAS = [\r\n    \"Adrar\", \"Chlef\", \"Laghouat\", \"Oum El Bouaghi\", \"Batna\", \"Béjaïa\", \"Biskra\", \"Bechar\", \"Blida\", \"Bouira\",\r\n    \"Tamanrasset\", \"Tbessa\", \"Tlemcen\", \"Tiaret\", \"Tizi Ouzou\", \"Alger\", \"Djelfa\", \"Jijel\", \"Se9tif\", \"Saefda\",\r\n    \"Skikda\", \"Sidi Bel Abbes\", \"Annaba\", \"Guelma\", \"Constantine\", \"Medea\", \"Mostaganem\", \"M'Sila\", \"Mascara\",\r\n    \"Ouargla\", \"Oran\", \"El Bayadh\", \"Illizi\", \"Bordj Bou Arreridj\", \"Boumerdes\", \"El Tarf\", \"Tindouf\", \"Tissemsilt\",\r\n    \"El Oued\", \"Khenchela\", \"Souk Ahras\", \"Tipaza\", \"Mila\", \"Ain Defla\", \"Naama\", \"Ain Temouchent\", \"Ghardaefa\",\r\n    \"Relizane\", \"El M'ghair\", \"El Menia\", \"Ouled Djellal\", \"Bordj Baji Mokhtar\", \"Béni Abbès\", \"Timimoun\",\r\n    \"Touggourt\", \"Djanet\", \"In Salah\", \"In Guezzam\", \"Aflou\", \"El Abiodh Sidi Cheikh\", \"El Aricha\", \"El Kantara\",\r\n    \"Barika\", \"Bou Saada\", \"Bir El Ater\", \"Ksar El Boukhari\", \"Ksar Chellala\", \"Ain Oussara\", \"Messaad\"\r\n];\r\n\r\nconst DEFAULT_DELIVERY_FEES: Record<string, { home: number, bureau: number }> = WILAYAS.reduce((acc, w) => {\r\n    const northWilayas = ['Alger', 'Blida', 'Boumerdès', 'Tipaza', 'Oran', 'Constantine', 'Annaba', 'Sétif'];\r\n    const southWilayas = ['Adrar', 'Tamanrasset', 'Illizi', 'Tindouf', 'Béchar', 'Ouargla', 'Ghardaïa'];\r\n\r\n    if (northWilayas.includes(w)) {\r\n        acc[w] = { home: 600, bureau: 350 };\r\n    } else if (southWilayas.includes(w)) {\r\n        acc[w] = { home: 1000, bureau: 600 };\r\n    } else {\r\n        acc[w] = { home: 800, bureau: 500 };\r\n    }\r\n    return acc;\r\n}, {} as Record<string, { home: number, bureau: number }>);\r\n\r\n// Default Admin for First Deployment\r\nconst INITIAL_USERS: User[] = [\r\n    {\r\n        id: 'admin-default',\r\n        email: 'admin@dattes.dz',\r\n        password: 'admin', // CHANGE THIS AFTER FIRST LOGIN\r\n        role: 'admin',\r\n        name: 'Administrateur',\r\n        wilaya: 'Biskra',\r\n        phone: '0000000000'\r\n    }\r\n];\r\n\r\ninterface StoreState {\r\n    language: Language;\r\n    setLanguage: (lang: Language) => void;\r\n    _hasHydrated: boolean;\r\n    setHasHydrated: (state: boolean) => void;\r\n\r\n    settings: SiteSettings;\r\n    updateSettings: (settings: Partial<SiteSettings>) => void;\r\n    fetchSettings: () => Promise<void>;\r\n\r\n    currentUser: User | null;\r\n    users: User[];\r\n    login: (email: string, password: string) => boolean;\r\n    logout: () => void;\r\n    register: (user: User) => boolean;\r\n\r\n    cart: CartItem[];\r\n    addToCart: (item: CartItem) => void;\r\n    removeFromCart: (id: string) => void;\r\n    updateQuantity: (id: string, quantityKg: number) => void;\r\n    clearCart: () => void;\r\n    cartTotal: () => number;\r\n    calculateTotal: () => number;\r\n\r\n    inventory: InventoryItem[];\r\n    updateInventory: (items: InventoryItem[]) => void;\r\n    fetchInventory: () => Promise<void>; // New Sync Method\r\n\r\n    orders: Order[];\r\n    addOrder: (order: Order) => void;\r\n    updateOrderStatus: (id: string, status: Order['status']) => void;\r\n    updateOrderReturn: (id: string, reason: string) => void;\r\n    fetchOrders: () => Promise<void>; // New Sync Method\r\n\r\n    updateUser: (userData: Partial<User>) => void;\r\n    fetchUsers: () => Promise<void>;\r\n\r\n    // Analytics Data\r\n    totalVisits: number;\r\n    incrementVisits: () => void;\r\n    analyticsData: {\r\n        traffic: { name: string; value: number }[];\r\n        conversion: { name: string; value: number }[];\r\n    };\r\n    updateAnalyticsData: (data: Partial<StoreState['analyticsData']>) => void;\r\n\r\n    referralSource: string;\r\n    setReferralSource: (source: string) => void;\r\n\r\n    // Updated to accept mode\r\n    getDeliveryFee: (wilaya: string, mode: 'home' | 'bureau') => number;\r\n}\r\n\r\nconst calculateDeliveryFee = (wilaya: string, mode: 'home' | 'bureau'): number => {\r\n    if (!wilaya) return 0;\r\n    const northWilayas = ['Alger', 'Blida', 'Boumerdès', 'Tipaza', 'Oran', 'Constantine', 'Annaba', 'Sétif'];\r\n    const southWilayas = ['Adrar', 'Tamanrasset', 'Illizi', 'Tindouf', 'Béchar', 'Ouargla', 'Ghardaïa'];\r\n\r\n    const isNorth = northWilayas.includes(wilaya);\r\n    const isSouth = southWilayas.includes(wilaya);\r\n\r\n    if (mode === 'home') {\r\n        if (isNorth) return 600;\r\n        if (isSouth) return 1000;\r\n        return 800;\r\n    } else {\r\n        // Bureau is cheaper\r\n        if (isNorth) return 350;\r\n        if (isSouth) return 600;\r\n        return 500;\r\n    }\r\n};\r\n\r\nconst INITIAL_INVENTORY_FINAL: InventoryItem[] = [];\r\n\r\nexport const useStore = create<StoreState>()(\r\n    persist(\r\n        (set, get) => ({\r\n            _hasHydrated: false,\r\n            setHasHydrated: (state) => set({ _hasHydrated: state }),\r\n\r\n            language: 'fr',\r\n            setLanguage: (lang) => set({ language: lang }),\r\n\r\n            settings: {\r\n                heroImage: '/hero-dates-v2.png',\r\n                heroImageDesktop: '/hero-dates-desktop.jpg',\r\n                deliveryFees: DEFAULT_DELIVERY_FEES\r\n            },\r\n            fetchSettings: async () => {\r\n                try {\r\n                    const res = await fetch('/api/settings');\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        set((state) => ({ settings: { ...state.settings, ...data } }));\r\n                    }\r\n                } catch (e) {\r\n                    console.error('Failed to fetch settings:', e);\r\n                }\r\n            },\r\n            updateSettings: (newSettings) => {\r\n                set((state) => {\r\n                    const updated = { ...state.settings, ...newSettings };\r\n\r\n                    // Sync to Server\r\n                    fetch('/api/settings', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify(newSettings)\r\n                    }).catch(err => console.error('Settings sync failed', err));\r\n\r\n                    return { settings: updated };\r\n                });\r\n            },\r\n\r\n            currentUser: null,\r\n            users: INITIAL_USERS,\r\n            login: (email, password) => {\r\n                // 1. Check Registered Users\r\n                const users = get().users;\r\n\r\n                // Find user in registered list\r\n                const user = users.find(u => u.email === email && u.password === password);\r\n\r\n                if (user) {\r\n                    set({ currentUser: user });\r\n                    return true;\r\n                }\r\n\r\n                return false;\r\n            },\r\n\r\n\r\n            logout: () => set({ currentUser: null }),\r\n            register: (newUser) => {\r\n                const exists = get().users.some(u => u.email === newUser.email);\r\n                if (exists) return false;\r\n                set(state => ({\r\n                    users: [...state.users, { ...newUser, id: crypto.randomUUID(), role: 'customer' }]\r\n                }));\r\n                return true;\r\n            },\r\n\r\n            cart: [],\r\n            addToCart: (item) => set((state) => {\r\n                const existing = state.cart.find(\r\n                    (i) => i.productId === item.productId && i.quality === item.quality && i.unit === item.unit && i.packaging === item.packaging\r\n                );\r\n                if (existing) {\r\n                    return {\r\n                        cart: state.cart.map((i) =>\r\n                            i.id === existing.id ? { ...i, quantityKg: i.quantityKg + item.quantityKg } : i\r\n                        ),\r\n                    };\r\n                }\r\n                return { cart: [...state.cart, item] };\r\n            }),\r\n            removeFromCart: (id) =>\r\n                set((state) => ({ cart: state.cart.filter((i) => i.id !== id) })),\r\n            updateQuantity: (id, q) =>\r\n                set((state) => ({\r\n                    cart: state.cart.map((i) => (i.id === id ? { ...i, quantityKg: q } : i)),\r\n                })),\r\n            clearCart: () => set({ cart: [] }),\r\n            cartTotal: () => {\r\n                const state = get();\r\n                return state.cart.reduce((acc, item) => acc + (item.pricePerKg * item.quantityKg), 0);\r\n            },\r\n            calculateTotal: () => {\r\n                const total = get().cartTotal();\r\n                // Default to 'home' for total calculation if mode isn't specified in state yet\r\n                // Ideally we should add 'deliveryMode' to the store state, but for now this fixes the build\r\n                const delivery = calculateDeliveryFee(get().currentUser?.wilaya || '', 'home');\r\n                return total + delivery;\r\n            },\r\n\r\n            // --- INVENTORY WITH API SYNC ---\r\n            inventory: INITIAL_INVENTORY_FINAL,\r\n            fetchInventory: async () => {\r\n                try {\r\n                    const res = await fetch('/api/products');\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        set({ inventory: data });\r\n                    }\r\n                } catch (e) {\r\n                    console.error('Failed to fetch inventory:', e);\r\n                }\r\n            },\r\n            updateInventory: (items) => {\r\n                set({ inventory: items });\r\n                // Sync to API\r\n                fetch('/api/products', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(items)\r\n                }).catch(err => console.error('Sync failed', err));\r\n            },\r\n\r\n            // --- ORDERS WITH API SYNC ---\r\n            orders: [],\r\n            fetchOrders: async () => {\r\n                try {\r\n                    const res = await fetch('/api/orders');\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        set({ orders: data });\r\n                    }\r\n                } catch (e) {\r\n                    console.error('Failed to fetch orders:', e);\r\n                }\r\n            },\r\n            addOrder: (order) => {\r\n                const newOrders = [order, ...get().orders];\r\n                set({ orders: newOrders });\r\n\r\n                // 1. Sync Single Order to API\r\n                fetch('/api/orders', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(order)\r\n                }).catch(err => console.error('Order sync failed', err));\r\n\r\n                // 2. Sync Stock Deduction\r\n                const currentInventory = [...get().inventory];\r\n                order.items.forEach(cartItem => {\r\n                    const productIndex = currentInventory.findIndex(p => p.id === cartItem.productId);\r\n                    if (productIndex !== -1) {\r\n                        currentInventory[productIndex] = {\r\n                            ...currentInventory[productIndex],\r\n                            stockKg: Math.max(0, currentInventory[productIndex].stockKg - cartItem.quantityKg)\r\n                        };\r\n                    }\r\n                });\r\n                get().updateInventory(currentInventory);\r\n            },\r\n            updateOrderStatus: (id, status) => {\r\n                const state = get();\r\n                const order = state.orders.find(o => o.id === id);\r\n                if (order) {\r\n                    const updatedOrder = { ...order, status };\r\n                    // Optimistic Update\r\n                    set((state) => ({\r\n                        orders: state.orders.map((o) => (o.id === id ? updatedOrder : o))\r\n                    }));\r\n\r\n                    // Sync to Backend\r\n                    fetch('/api/orders', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify(updatedOrder)\r\n                    }).catch(err => console.error('Failed to sync order status:', err));\r\n                }\r\n            },\r\n            updateOrderReturn: (id, reason) => {\r\n                const state = get();\r\n                const order = state.orders.find(o => o.id === id);\r\n                if (order) {\r\n                    const updatedOrder = { ...order, status: 'returned' as const, returnReason: reason };\r\n                    // Optimistic Update\r\n                    set((state) => ({\r\n                        orders: state.orders.map(o => o.id === id ? updatedOrder : o)\r\n                    }));\r\n\r\n                    // Sync to Backend\r\n                    fetch('/api/orders', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify(updatedOrder)\r\n                    }).catch(err => console.error('Failed to sync order return:', err));\r\n                }\r\n            },\r\n\r\n            updateUser: (userData) => {\r\n                const state = get();\r\n                const currentUser = state.currentUser;\r\n\r\n                if (currentUser) {\r\n                    const updatedUser = { ...currentUser, ...userData };\r\n\r\n                    // Optimistic update\r\n                    set((state) => ({\r\n                        currentUser: updatedUser,\r\n                        users: state.users.map(u => u.id === currentUser.id ? updatedUser : u)\r\n                    }));\r\n\r\n                    // Sync to Backend\r\n                    fetch('/api/users', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify(updatedUser)\r\n                    }).catch(err => console.error('Failed to sync user update:', err));\r\n                }\r\n            },\r\n\r\n            fetchUsers: async () => {\r\n                try {\r\n                    const res = await fetch('/api/users');\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        if (Array.isArray(data) && data.length > 0) {\r\n                            set({ users: data });\r\n                        } else {\r\n                            // Initial Seed if Empty\r\n                            console.log('Seeding initial users to Firestore...');\r\n                            await fetch('/api/users', {\r\n                                method: 'POST',\r\n                                headers: { 'Content-Type': 'application/json' },\r\n                                body: JSON.stringify(INITIAL_USERS)\r\n                            });\r\n                            set({ users: INITIAL_USERS });\r\n                        }\r\n                    }\r\n                } catch (e) {\r\n                    console.error('Failed to fetch users:', e);\r\n                }\r\n            },\r\n\r\n            // Analytics\r\n            totalVisits: 0,\r\n            incrementVisits: () => set((state) => ({ totalVisits: state.totalVisits + 1 })),\r\n            analyticsData: {\r\n                traffic: [\r\n                    { name: 'Lun', value: 400 },\r\n                    { name: 'Mar', value: 300 },\r\n                    { name: 'Mer', value: 550 },\r\n                    { name: 'Jeu', value: 450 },\r\n                    { name: 'Ven', value: 600 },\r\n                    { name: 'Sam', value: 700 },\r\n                    { name: 'Dim', value: 500 },\r\n                ],\r\n                conversion: [\r\n                    { name: 'Lun', value: 24 },\r\n                    { name: 'Mar', value: 18 },\r\n                    { name: 'Mer', value: 35 },\r\n                    { name: 'Jeu', value: 28 },\r\n                    { name: 'Ven', value: 42 },\r\n                    { name: 'Sam', value: 48 },\r\n                    { name: 'Dim', value: 38 },\r\n                ],\r\n            },\r\n            updateAnalyticsData: (data) => set((state) => ({\r\n                analyticsData: { ...state.analyticsData, ...data }\r\n            })),\r\n\r\n            referralSource: '',\r\n            setReferralSource: (source) => set({ referralSource: source }),\r\n\r\n            getDeliveryFee: (wilaya, mode) => {\r\n                const fees = get().settings.deliveryFees;\r\n                if (fees[wilaya]) {\r\n                    return fees[wilaya][mode];\r\n                }\r\n                return calculateDeliveryFee(wilaya, mode);\r\n            }\r\n        }),\r\n        {\r\n            name: 'dattes-storage-v5',\r\n            storage: createJSONStorage(() => localStorage),\r\n            version: 5,\r\n            migrate: (persistedState: any, version) => {\r\n                if (version < 5) {\r\n                    // Smart Merge: Update text/translations from code, but KEEP user's stock/prices/images\r\n                    const oldInventory = persistedState.inventory || [];\r\n                    const mergedInventory = INITIAL_INVENTORY_FINAL.map(initialItem => {\r\n                        const existingItem = oldInventory.find((i: any) => i.id === initialItem.id);\r\n\r\n                        if (existingItem) {\r\n                            // Merge logic:\r\n                            // 1. Keep user-mutable fields from storage (Stock, Price, Images)\r\n                            // 2. Force-update static text fields from code (Descriptions, Translations)\r\n                            return {\r\n                                ...initialItem, // Start with fresh code data (fixes typos/translations)\r\n                                stockKg: existingItem.stockKg, // Restore user stock\r\n                                pricePerKg: existingItem.pricePerKg, // Restore user price\r\n                                images: existingItem.images, // Restore user images\r\n                            };\r\n                        }\r\n                        return initialItem; // New item found in code? Add it.\r\n                    });\r\n\r\n                    return {\r\n                        ...persistedState,\r\n                        inventory: mergedInventory,\r\n                    };\r\n                }\r\n                return persistedState as StoreState;\r\n            },\r\n            partialize: (state) => ({\r\n                // Persist ONLY user-local settings.\r\n                // DATA (Inventory/Orders) must come from Server (JSON API).\r\n                language: state.language,\r\n                cart: state.cart,\r\n                settings: state.settings,\r\n                currentUser: state.currentUser,\r\n                users: state.users, // Persist users for login session\r\n                totalVisits: state.totalVisits,\r\n                analyticsData: state.analyticsData\r\n            }),\r\n            onRehydrateStorage: () => (state) => {\r\n                state?.setHasHydrated(true);\r\n            },\r\n        }\r\n    )\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 783, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/components/StoreInitializer.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect } from 'react';\r\nimport { useStore } from '@/lib/store';\r\n\r\nexport function StoreSync() {\r\n    const { fetchInventory, fetchOrders, fetchSettings } = useStore();\r\n\r\n    useEffect(() => {\r\n        // Fetch data immediately on mount\r\n        fetchInventory();\r\n        fetchOrders();\r\n        fetchSettings();\r\n    }, [fetchInventory, fetchOrders, fetchSettings]);\r\n\r\n    return null; // This component renders nothing\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS;IACZ,MAAM,EAAE,cAAc,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,IAAA,wHAAQ;IAE/D,IAAA,kNAAS,EAAC;QACN,kCAAkC;QAClC;QACA;QACA;IACJ,GAAG;QAAC;QAAgB;QAAa;KAAc;IAE/C,OAAO,MAAM,iCAAiC;AAClD"}}]
}