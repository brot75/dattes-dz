{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps } from 'firebase/app';\r\nimport { getStorage } from 'firebase/storage';\r\nimport { getFirestore } from 'firebase/firestore';\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyD5Z-beYBUJS5kL0VjftPizpahVrP5Od44\",\r\n    authDomain: \"abdattes-production-2026.firebaseapp.com\",\r\n    projectId: \"abdattes-production-2026\",\r\n    storageBucket: \"abdattes-production-2026.firebasestorage.app\",\r\n    messagingSenderId: \"1010651736384\",\r\n    appId: \"1:1010651736384:web:2476a3f0474d76a110f2a5\"\r\n};\r\n\r\n// Initialize Firebase (Singleton pattern)\r\nconst app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\r\n\r\nexport const storage = getStorage(app);\r\nexport const db = getFirestore(app);\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACnB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;AACX;AAEA,0CAA0C;AAC1C,MAAM,MAAM,IAAA,6KAAO,IAAG,MAAM,KAAK,IAAI,IAAA,mLAAa,EAAC,kBAAkB,IAAA,6KAAO,GAAE,CAAC,EAAE;AAE1E,MAAM,UAAU,IAAA,oMAAU,EAAC;AAC3B,MAAM,KAAK,IAAA,mLAAY,EAAC"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/app/api/products/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { db } from '@/lib/firebase';\r\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nconst INVENTORY_DOC = 'main';\r\nconst DATA_FILE = path.join(process.cwd(), 'data', 'products.json');\r\n\r\n// Helper to read local backup (Migration source)\r\nconst readLocalData = () => {\r\n    try {\r\n        if (!fs.existsSync(DATA_FILE)) return [];\r\n        const fileData = fs.readFileSync(DATA_FILE, 'utf-8');\r\n        return JSON.parse(fileData);\r\n    } catch (error) {\r\n        return [];\r\n    }\r\n};\r\n\r\nexport async function GET() {\r\n    try {\r\n        const docRef = doc(db, 'inventory', INVENTORY_DOC);\r\n        const docSnap = await getDoc(docRef);\r\n\r\n        if (docSnap.exists() && docSnap.data().items?.length > 0) {\r\n            return NextResponse.json(docSnap.data().items);\r\n        }\r\n\r\n        // --- AUTO-MIGRATION ---\r\n        // If Firestore is empty, seed it with local data\r\n        console.log('Firestore inventory empty. Migrating from local JSON...');\r\n        const localProducts = readLocalData();\r\n\r\n        if (localProducts.length > 0) {\r\n            await setDoc(docRef, { items: localProducts });\r\n        }\r\n\r\n        return NextResponse.json(localProducts);\r\n\r\n    } catch (error) {\r\n        console.error('Firestore get error:', error);\r\n        // Fallback to local if Cloud fails completely\r\n        return NextResponse.json(readLocalData());\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const body = await request.json();\r\n\r\n        if (Array.isArray(body)) {\r\n            const docRef = doc(db, 'inventory', INVENTORY_DOC);\r\n            await setDoc(docRef, { items: body });\r\n            return NextResponse.json({ success: true, message: 'Inventory updated', data: body });\r\n        }\r\n        return NextResponse.json({ success: false, message: 'Invalid format' }, { status: 400 });\r\n    } catch (error) {\r\n        console.error('Firestore save error:', error);\r\n        return NextResponse.json({ success: false, message: 'Server Error' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AACA;;;;;;AAEO,MAAM,UAAU;AAEvB,MAAM,gBAAgB;AACtB,MAAM,YAAY,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEnD,iDAAiD;AACjD,MAAM,gBAAgB;IAClB,IAAI;QACA,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,YAAY,OAAO,EAAE;QACxC,MAAM,WAAW,wGAAE,CAAC,YAAY,CAAC,WAAW;QAC5C,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAO,OAAO;QACZ,OAAO,EAAE;IACb;AACJ;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,SAAS,IAAA,0KAAG,EAAC,uHAAE,EAAE,aAAa;QACpC,MAAM,UAAU,MAAM,IAAA,6KAAM,EAAC;QAE7B,IAAI,QAAQ,MAAM,MAAM,QAAQ,IAAI,GAAG,KAAK,EAAE,SAAS,GAAG;YACtD,OAAO,gJAAY,CAAC,IAAI,CAAC,QAAQ,IAAI,GAAG,KAAK;QACjD;QAEA,yBAAyB;QACzB,iDAAiD;QACjD,QAAQ,GAAG,CAAC;QACZ,MAAM,gBAAgB;QAEtB,IAAI,cAAc,MAAM,GAAG,GAAG;YAC1B,MAAM,IAAA,6KAAM,EAAC,QAAQ;gBAAE,OAAO;YAAc;QAChD;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAE7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,8CAA8C;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B;AACJ;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,IAAI,MAAM,OAAO,CAAC,OAAO;YACrB,MAAM,SAAS,IAAA,0KAAG,EAAC,uHAAE,EAAE,aAAa;YACpC,MAAM,IAAA,6KAAM,EAAC,QAAQ;gBAAE,OAAO;YAAK;YACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,SAAS;gBAAqB,MAAM;YAAK;QACvF;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;QAAiB,GAAG;YAAE,QAAQ;QAAI;IAC1F,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IACxF;AACJ"}}]
}