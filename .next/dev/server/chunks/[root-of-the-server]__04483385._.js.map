{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/dattes-dz/app/api/settings/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Force dynamic to ensure we always read the file\r\nexport const dynamic = 'force-dynamic';\r\n\r\nconst dataFilePath = path.join(process.cwd(), 'data/settings.json');\r\n\r\n// Helper to ensure data directory exists\r\nconst ensureDataDir = () => {\r\n    const dir = path.dirname(dataFilePath);\r\n    if (!fs.existsSync(dir)) {\r\n        fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(dataFilePath)) {\r\n        // Create default if missing\r\n        fs.writeFileSync(dataFilePath, JSON.stringify({\r\n            heroImage: '/hero-dates-v2.png',\r\n            deliveryFees: {}\r\n        }, null, 2));\r\n    }\r\n};\r\n\r\nexport async function GET() {\r\n    try {\r\n        ensureDataDir();\r\n        const fileData = fs.readFileSync(dataFilePath, 'utf8');\r\n        const settings = JSON.parse(fileData);\r\n        return NextResponse.json(settings);\r\n    } catch (error) {\r\n        console.error('Error reading settings:', error);\r\n        return NextResponse.json({ error: 'Failed to load settings' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const newSettings = await request.json();\r\n        ensureDataDir();\r\n\r\n        // Read existing to merge (don't overwrite deep keys if not needed, but here simple replace/merge is fine)\r\n        let existing = {};\r\n        try {\r\n            existing = JSON.parse(fs.readFileSync(dataFilePath, 'utf8'));\r\n        } catch (e) {\r\n            // ignore\r\n        }\r\n\r\n        const merged = { ...existing, ...newSettings }; // Shallow merge\r\n\r\n        fs.writeFileSync(dataFilePath, JSON.stringify(merged, null, 2));\r\n\r\n        return NextResponse.json({ success: true, settings: merged });\r\n    } catch (error) {\r\n        console.error('Error saving settings:', error);\r\n        return NextResponse.json({ error: 'Failed to save settings' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAGO,MAAM,UAAU;AAEvB,MAAM,eAAe,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAE9C,yCAAyC;AACzC,MAAM,gBAAgB;IAClB,MAAM,MAAM,4GAAI,CAAC,OAAO,CAAC;IACzB,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,MAAM;QACrB,wGAAE,CAAC,SAAS,CAAC,KAAK;YAAE,WAAW;QAAK;IACxC;IACA,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,eAAe;QAC9B,4BAA4B;QAC5B,wGAAE,CAAC,aAAa,CAAC,cAAc,KAAK,SAAS,CAAC;YAC1C,WAAW;YACX,cAAc,CAAC;QACnB,GAAG,MAAM;IACb;AACJ;AAEO,eAAe;IAClB,IAAI;QACA;QACA,MAAM,WAAW,wGAAE,CAAC,YAAY,CAAC,cAAc;QAC/C,MAAM,WAAW,KAAK,KAAK,CAAC;QAC5B,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,cAAc,MAAM,QAAQ,IAAI;QACtC;QAEA,0GAA0G;QAC1G,IAAI,WAAW,CAAC;QAChB,IAAI;YACA,WAAW,KAAK,KAAK,CAAC,wGAAE,CAAC,YAAY,CAAC,cAAc;QACxD,EAAE,OAAO,GAAG;QACR,SAAS;QACb;QAEA,MAAM,SAAS;YAAE,GAAG,QAAQ;YAAE,GAAG,WAAW;QAAC,GAAG,gBAAgB;QAEhE,wGAAE,CAAC,aAAa,CAAC,cAAc,KAAK,SAAS,CAAC,QAAQ,MAAM;QAE5D,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,UAAU;QAAO;IAC/D,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ"}}]
}